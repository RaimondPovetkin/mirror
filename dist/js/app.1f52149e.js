(function(){var t={9675:function(t,e,i){"use strict";var o=i(9242),s=i(3396);const n={id:"app"};function a(t,e,i,o,a,r){const d=(0,s.up)("router-view");return(0,s.wg)(),(0,s.iD)("div",n,[(0,s.Wm)(d)])}var r={name:"App",components:{}},d=i(89);const h=(0,d.Z)(r,[["render",a]]);var l=h,c=i(2483);const p={class:"first-page",id:"butter"};function u(t,e,i,o,n,a){const r=(0,s.up)("title-page"),d=(0,s.up)("slider-home");return(0,s.wg)(),(0,s.iD)("div",p,[(0,s.Wm)(r),(0,s.Wm)(d)])}var m=i.p+"img/mir1.a31f46a8.jpg",g=i.p+"img/mir2.7399cfc6.jpg",v=i.p+"img/mir3.9bb5f2fb.jpg",w=i.p+"img/mir4.2ac9f67e.jpg";const f={class:"slider text"},b=(0,s.uE)('<div class="title" data-v-9d69cfd2>Работы наших креативных клиентов</div><div class="wrapper-block" data-v-9d69cfd2><div class="content-row" data-v-9d69cfd2><div class="card-item" data-v-9d69cfd2><div class="card-image" data-v-9d69cfd2><img class="image" src="'+m+'" data-v-9d69cfd2></div><div class="card-sign" data-v-9d69cfd2>Ольга Иванова г.Москва</div><div class="card-button button" data-v-9d69cfd2>ХОЧУ ТАКОЕ ЖЕ</div></div><div class="card-item" data-v-9d69cfd2><div class="card-image" data-v-9d69cfd2><img class="image" src="'+g+'" data-v-9d69cfd2></div><div class="card-sign" data-v-9d69cfd2>Ольга Иванова г.Москва</div><div class="card-button button" data-v-9d69cfd2>ХОЧУ ТАКОЕ ЖЕ</div></div><div class="card-item" data-v-9d69cfd2><div class="card-image" data-v-9d69cfd2><img class="image" src="'+v+'" data-v-9d69cfd2></div><div class="card-sign" data-v-9d69cfd2>Ольга Иванова г.Москва</div><div class="card-button button" data-v-9d69cfd2>ХОЧУ ТАКОЕ ЖЕ</div></div><div class="card-item" data-v-9d69cfd2><div class="card-image" data-v-9d69cfd2><img class="image" src="'+w+'" data-v-9d69cfd2></div><div class="card-sign" data-v-9d69cfd2>Ольга Иванова г.Москва</div><div class="card-button button" data-v-9d69cfd2>ХОЧУ ТАКОЕ ЖЕ</div></div></div></div><div class="wrapper-block" data-v-9d69cfd2><div class="content-row" data-v-9d69cfd2><div class="card-item" data-v-9d69cfd2><div class="card-image" data-v-9d69cfd2><img class="image" src="'+m+'" data-v-9d69cfd2></div><div class="card-sign" data-v-9d69cfd2>Ольга Иванова г.Москва</div><div class="card-button button" data-v-9d69cfd2>ХОЧУ ТАКОЕ ЖЕ</div></div><div class="card-item" data-v-9d69cfd2><div class="card-image" data-v-9d69cfd2><img class="image" src="'+g+'" data-v-9d69cfd2></div><div class="card-sign" data-v-9d69cfd2>Ольга Иванова г.Москва</div><div class="card-button button" data-v-9d69cfd2>ХОЧУ ТАКОЕ ЖЕ</div></div><div class="card-item" data-v-9d69cfd2><div class="card-image" data-v-9d69cfd2><img class="image" src="'+v+'" data-v-9d69cfd2></div><div class="card-sign" data-v-9d69cfd2>Ольга Иванова г.Москва</div><div class="card-button button" data-v-9d69cfd2>ХОЧУ ТАКОЕ ЖЕ</div></div><div class="card-item" data-v-9d69cfd2><div class="card-image" data-v-9d69cfd2><img class="image" src="'+w+'" data-v-9d69cfd2></div><div class="card-sign" data-v-9d69cfd2>Ольга Иванова г.Москва</div><div class="card-button button" data-v-9d69cfd2>ХОЧУ ТАКОЕ ЖЕ</div></div></div></div><div class="trigger" data-v-9d69cfd2></div>',4),y=[b];function x(t,e,i,o,n,a){return(0,s.wg)(),(0,s.iD)("div",f,y)}var P={name:"HelloWorld",data:()=>({count:0,observer:null}),watch:{count(){console.log(document)}},props:{msg:String},computed:{},mounted(){this.observer=new IntersectionObserver(this.returnOnEntry(),{threshold:[.9]}),this.observer.observe(document.getElementsByClassName("trigger")[0])},methods:{returnOnEntry(){let t=this;return function(e){e.forEach((e=>{e.isIntersecting&&t.count++}))}}}};const C=(0,d.Z)(P,[["render",x],["__scopeId","data-v-9d69cfd2"]]);var S=C;const k={class:"video-container"},R={class:"caption"},_={class:"title_container text"},M=(0,s.uE)('<div class="first-word">Белое зеркало</div><div class="second-row"><span class="second-word">Создай своё  </span><span class="third-word"> уникальное зеркало</span></div><div class="second-row"><span class="description">Нарисуй форму, выбери раму, цвет и крепление. А мы приедем и установим его в удобное время</span></div>',3),I={class:"second-row"};function L(t,e,i,o,n,a){return(0,s.wg)(),(0,s.iD)("div",k,[(0,s._)("div",R,[(0,s._)("div",_,[M,(0,s._)("div",I,[(0,s._)("button",{class:"button",onClick:e[0]||(e[0]=(...t)=>a.toDrawPage&&a.toDrawPage(...t))},"СОЗДАТЬ")])])])])}i(7658);var T={name:"TitlePage",methods:{goDraw(){},toDrawPage(){this.$router.push("/draw")}}};const j=(0,d.Z)(T,[["render",L]]);var z=j,A={name:"FirstPage",components:{TitlePage:z,sliderHome:S},mounted(){var t={wrapperDamper:.05,cancelOnTouch:!0};window.butter.init(t)}};const D=(0,d.Z)(A,[["render",u],["__scopeId","data-v-52856dbb"]]);var E=D,W=i(7139);const H={style:{width:"100%",height:"100%",display:"flex"},class:"draw-page"},O={key:0},F={style:{height:"100vh",width:"100%"}},N=(0,s._)("h3",{text:"2xl",justify:"center"},"333",-1);function B(t,e,i,o,n,a){const r=(0,s.up)("ArrowLeft"),d=(0,s.up)("el-icon"),h=(0,s.up)("el-button"),l=(0,s.up)("router-link"),c=(0,s.up)("master-paper"),p=(0,s.up)("el-carousel-item"),u=(0,s.up)("main-wrap"),m=(0,s.up)("el-carousel");return(0,s.wg)(),(0,s.iD)("div",H,[(0,s.Wm)(l,{to:"/"},{default:(0,s.w5)((()=>[t.widthScreen>570?((0,s.wg)(),(0,s.j4)(h,{key:0,onMouseover:e[0]||(e[0]=e=>t.upHere=!0),onMouseleave:e[1]||(e[1]=e=>t.upHere=!1),class:"button-home"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{class:"arrow-left",size:20,style:(0,W.j5)([{"margin-top":"-5px"},t.upHere&&t.widthScreen>570?"transform: translateX(-7px);  transition: .5s;":""])},{default:(0,s.w5)((()=>[(0,s.Wm)(r)])),_:1},8,["style"]),t.widthScreen>890?((0,s.wg)(),(0,s.iD)("span",O,"Белое зеркало")):(0,s.kq)("",!0)])),_:1})):(0,s.kq)("",!0)])),_:1}),(0,s._)("div",F,[(0,s.Wm)(m,{ref:"carousel",style:{height:"100%"},direction:"vertical",autoplay:!1},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{onChangeIndex:a.setActiveItem,onSetPathCurveExternal:a.setPathCurveExternal,returnLastVertionTrigger:t.returnLastVertionTrigger},null,8,["onChangeIndex","onSetPathCurveExternal","returnLastVertionTrigger"])])),_:1}),(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{onChangeIndex:a.setActiveItem,pathCurve:t.pathCurve,pathCurveExternal:t.pathCurveExternal},null,8,["onChangeIndex","pathCurve","pathCurveExternal"])])),_:1}),(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[N])),_:1})])),_:1},512)])])}var V=i.p+"img/frame1.561435d6.png",$=i.p+"img/frame2.eb95a4d3.png",Z=i.p+"img/frame3.9909d761.png";const q=t=>((0,s.dD)("data-v-97ca4a86"),t=t(),(0,s.Cn)(),t),U={class:"frame-content-wrap"},G=q((()=>(0,s._)("img",{class:"menu-image",src:V},null,-1))),Y=[G],J=q((()=>(0,s._)("img",{class:"menu-image",src:$},null,-1))),K=[J],X=q((()=>(0,s._)("img",{class:"menu-image",src:Z},null,-1))),Q=[X],tt={key:0,class:"preload"},et=q((()=>(0,s._)("div",{id:"container"},null,-1)));function it(t,e,i,o,n,a){const r=(0,s.up)("el-button"),d=(0,s.up)("el-popover");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(r,{class:"button-form",onClick:a.toDrawPage},{default:(0,s.w5)((()=>[(0,s.Uk)("форма")])),_:1},8,["onClick"]),(0,s.Wm)(d,{ref:"popoverFrame",placement:"left-start",title:"Title",width:150,trigger:"click",content:"this is content, this is content, this is content"},{reference:(0,s.w5)((()=>[(0,s.Wm)(r,{class:"button-frame"},{default:(0,s.w5)((()=>[(0,s.Uk)("Рама")])),_:1})])),default:(0,s.w5)((()=>[(0,s._)("div",U,[(0,s._)("div",{class:"frameIMG",style:(0,W.j5)(0==n.frameIndex?"background-color: #7a7b81":""),onClick:e[0]||(e[0]=(...t)=>a.setFrame1&&a.setFrame1(...t))},Y,4),(0,s._)("div",{class:"frameIMG",style:(0,W.j5)(1==n.frameIndex?"background-color: #7a7b81":""),onClick:e[1]||(e[1]=(...t)=>a.setFrame2&&a.setFrame2(...t))},K,4),(0,s._)("div",{class:"frameIMG",style:(0,W.j5)(2==n.frameIndex?"background-color: #7a7b81":""),onClick:e[2]||(e[2]=(...t)=>a.setFrame3&&a.setFrame3(...t))},Q,4)])])),_:1},512),(0,s.Wm)(r,{class:"button-fastening",onClick:a.fastening},{default:(0,s.w5)((()=>[(0,s.Uk)("крепление")])),_:1},8,["onClick"]),(0,s.Wm)(r,{class:"button-ordering",onClick:e[3]||(e[3]=e=>t.$emit("changeIndex",2))},{default:(0,s.w5)((()=>[(0,s.Uk)("оформление")])),_:1}),n.preloader?((0,s.wg)(),(0,s.iD)("div",tt,"прелоадер")):(0,s.kq)("",!0),et],64)}var ot=i(1114),st=i(4543),nt=i(1273),at=i(499);let rt,dt,ht=!1,lt=0,ct=0;var pt={name:"MainWrap.vue",props:{pathCurve:Object},data(){return{frameIndex:0,correctPath:[],startCoord:{},xGap:null,yGap:null,segments:[],preloader:!0,firstInit:!1,canvas:null,controls:null,camera:"",geometry:"",material:"",selectObject:{},requestID:""}},mounted(){this.pathCurve&&(window.addEventListener("resize",this.onWindowResize,!1),window.addEventListener("click",this.onMouseDblclick,!1),document.getElementById("container").addEventListener("mousemove",this.onMouseMove),document.getElementById("container").addEventListener("mousedown",this.onMouseDown),document.getElementById("container").addEventListener("mouseup",this.onMouseUp))},beforeUnmount(){document.getElementById("container").removeEventListener("resize",this.onWindowResize),document.getElementById("container").removeEventListener("click",this.onMouseDblclick),document.getElementById("container").removeEventListener("mousemove",this.onMouseMoveT),window.cancelAnimationFrame(this.requestID)},watch:{async pathCurve(t){if(t&&!this.firstInit)console.log(t),this.firstInit=!0,await this.init(),window.addEventListener("resize",this.onWindowResize,!1),window.addEventListener("click",this.onMouseDblclick,!1),document.getElementById("container").addEventListener("mousemove",this.onMouseMove),document.getElementById("container").addEventListener("mousedown",this.onMouseDown),document.getElementById("container").addEventListener("mouseup",this.onMouseUp);else if(t&&this.firstInit){this.removeMeshes();const t=rt.getObjectByProperty("type","Reflector");t.geometry.dispose(),t.material.dispose(),rt.remove(t),console.log(rt),dt.renderLists.dispose(),await this.createGeometry(!1)}}},methods:{addBackSurface(){var t=new ot._12(40,40),e=new ot.xoR({color:9027027}),i=new ot.Kj0(t,e);i.receiveShadow=!0,i.castShadow=!0,i.rotation.x=-Math.PI/2,i.rotation.y=Math.PI/2,i.position.set(-4.99,-5,0),rt.add(i)},toDrawPage(){this.$refs.popoverFrame.hide(),this.$emit("changeIndex",0)},fastening(){this.$refs.popoverFrame.hide(),this.controls.maxAzimuthAngle=1/0,this.controls.minAzimuthAngle=1/0,this.controls.maxPolarAngle=Math.PI,this.controls.minPolarAngle=0,console.log(this.camera);let t=(this.camera.position.x- -30)/100,e=(this.camera.position.y- -16)/100,i=(this.camera.position.z-19)/100,o=0,s=setInterval((()=>{this.camera.position.x-=t,this.camera.position.y-=e,this.camera.position.z-=i,o++,100==o&&window.clearInterval(s)}),10)},rotateScene(){},onMouseMove(t){if(ht){console.log("move"),t.preventDefault();var e=t.clientX-lt,i=t.clientY-ct;lt=t.clientX,ct=t.clientY,this.rotateScene(e,i)}},onMouseDown(t){ht=!0,lt=t.clientX,ct=t.clientY},onMouseUp(){ht=!1},async init(){rt=new ot.xsS,this.camera=new ot.cPb(45,window.innerWidth/window.innerHeight,1,500),this.camera.up.set(0,-1,0),this.camera.position.z=39,this.camera.position.x=3,this.camera.position.y=-6,await this.createGeometry(),await this.createRender(),this.controls=new st.z(this.camera,this.canvas),this.controls.rotateSpeed=.9,this.controls.zoomSpeed=.9,this.controls.panSpeed=0,this.controls.maxAzimuthAngle=.01,this.controls.minAzimuthAngle=-2.9,this.controls.maxPolarAngle=2,this.controls.minPolarAngle=1,this.controls.enableDamping=!0,this.controls.dampingFactor=.1,this.controls.update(),this.animate(),this.addLight()},addLight(){const t=new ot.vmT(16777215,12155424,.5);rt.add(t);const e=new ot.cek(16777215,.2);e.position.copy(this.camera.position),e.position.x=-30,e.position.y=-50,e.position.z=-5,console.log(e);const i=new ot.cek(16777215,.6);i.position.copy(this.camera.position),i.position.x=100,i.position.y=150,i.position.z=-5;const o=new ot.cek(16777215,.3);o.position.copy(this.camera.position),o.position.x=-40,o.position.y=-50,o.position.z=30;var s=new ot.cek(16777215,.4);s.position.set(15,-20,10),s.castShadow=!0,s.shadow.mapSize.width=4e3,s.shadow.mapSize.height=4e3,rt.add(s),rt.add(e)},onMouseMoveT(){event.preventDefault()},createGeometry(t=!0){console.log(this.pathCurve),this.startCoord={},this.correctPath=[];let e=this.xGap=this.pathCurve[0].curve.points[0].x,i=this.yGap=this.pathCurve[0].curve.points[0].y;for(let r=0;r<this.pathCurve.length;r++)this.pathCurve[r].curve.points[3].x<e&&(e=this.pathCurve[r].curve.points[3].x),this.pathCurve[r].curve.points[3].y<i&&(i=this.pathCurve[r].curve.points[3].y);console.log(e,i);for(let r=0;r<this.pathCurve.length;r++){let t={};t.x=(this.pathCurve[r].curve.points[3].x-e)/10,t.y=(this.pathCurve[r].curve.points[3].y-i)/10,this.correctPath.push(t)}this.startCoord.x=(this.pathCurve[0].curve.points[0].x-e)/10,this.startCoord.y=(this.pathCurve[0].curve.points[0].y-i)/10;var o=new ot.bnF;o.moveTo(this.startCoord.x,this.startCoord.y);let s=[];for(let r=0;r<this.correctPath.length-1;r++)s.push(new ot.FM8(this.correctPath[r].x,this.correctPath[r].y));console.log(s),o.splineThru(s);const n=new ot.oa8(o,100);let a=new nt.r(n,{clipBias:.002,color:8952217});if(a.position.x=-4.25,a.position.y=-14,a.position.z=8,a.rotation.y=1.57,a.scale.x=.4,a.scale.y=.4,a.scale.z=.4,rt.add(a),this.setFrame1(),t){const t=new at.L;t.load("../../InteriorTest.obj",(t=>{const e=t;e.position.x=32.5,e.position.y=20,e.scale.x=15,e.scale.y=15,e.scale.z=15,e.rotation.z=Math.PI,e.receiveShadow=!0,e.castShadow=!0,rt.add(t),this.preloader=!1,console.log("good")}))}},createRender(){dt=new ot.CP7({antialias:!0}),dt.setSize(window.innerWidth,window.innerHeight),dt.setClearColor(12178431,1),dt.shadowMap.enabled=!0;let t=document.getElementById("container");t.appendChild(dt.domElement),this.canvas=dt.domElement},animate(){this.controls.update(),this.requestID=requestAnimationFrame(this.animate),this.render()},render(){dt.render(rt,this.camera)},onWindowResize(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),dt.setSize(window.innerWidth,window.innerHeight)},onMouseDblclick(t){var e=this.getIntersects(t);0!=e.length&&(e[0].object,ot.Kj0)},getIntersects(t){t.preventDefault();var e=new ot.iMs,i=new ot.FM8;i.x=t.clientX/window.innerWidth*2-1,i.y=-t.clientY/window.innerHeight*2+1,e.setFromCamera(i,this.camera);var o=e.intersectObjects(rt.children);return o},setMirorBack(){var t=new ot.bnF;t.moveTo(this.startCoord.x,this.startCoord.y);let e=[];for(let n=0;n<this.correctPath.length-1;n++)e.push(new ot.FM8(this.correctPath[n].x,this.correctPath[n].y));t.splineThru(e);let i=new ot.O7d(t,{curveSegments:162,depth:.3,bevelEnabled:!1});var o=new ot.vBJ({color:9871014});let s=new ot.Kj0(i,o);s.position.x=-4.4,s.position.y=-14,s.position.z=8,s.rotation.y=1.57,s.scale.x=.4,s.scale.y=.4,s.scale.z=.4,s.name="MirorBack",s.receiveShadow=!0,s.castShadow=!0,rt.add(s)},removeMeshes(){for(let t=rt.children.length-1;t>=0;t--)"Mesh"===rt.children[t].type&&(console.log(rt.children[t].material),rt.children[t].geometry.dispose(),rt.children[t].material.length?(rt.children[t].material[0].dispose(),rt.children[t].material[1].dispose()):rt.children[t].material.dispose(),rt.remove(rt.children[t]))},setFrame1(){console.log("333");const t=rt.getObjectByProperty("name","MirorBack");t&&(t.geometry.dispose(),t.material.dispose(),rt.remove(t)),this.removeMeshes(),this.addBackSurface(),this.frameIndex=0;var e=new ot.bnF;e.moveTo(this.startCoord.x,this.startCoord.y);let i=[];for(let h=0;h<this.correctPath.length-1;h++)i.push(new ot.FM8(this.correctPath[h].x,this.correctPath[h].y));e.splineThru(i);const o=new ot.dpR;let s=new ot.O7d(e,{curveSegments:162,depth:3,bevelEnabled:!1}),n=o.load("../../Texture/treeD.jpg");n.wrapS=n.wrapT=ot.rpg,n.repeat.set(.05,.1),n.offset.set(.1,.1),n.rotation=1.55;let a=o.load("../../Texture/treeD.jpg");a.wrapS=a.wrapT=ot.rpg,a.repeat.set(.05,.1),a.offset.set(.1,.01),a.rotation=0;let r=[new ot.xoR({map:n}),new ot.xoR({map:a})],d=new ot.Kj0(s,r);d.position.x=-5.5,d.position.y=-14,d.position.z=8,d.rotation.y=1.57,d.scale.x=.4,d.scale.y=.4,d.scale.z=.4,d.receiveShadow=!0,d.castShadow=!0,rt.add(d)},setFrame2(){this.frameIndex=1,this.removeMeshes(),this.setMirorBack(),this.addBackSurface()},setFrame3(){this.removeMeshes(),this.setMirorBack(),this.addBackSurface(),this.frameIndex=2;const t=new ot.dpR;let e=t.load("../../Texture/treeD.jpg");e.wrapS=e.wrapT=ot.rpg,e.repeat.set(.05,.1),e.offset.set(.1,.1),e.rotation=1.55;let i=t.load("../../Texture/treeD.jpg");i.wrapS=i.wrapT=ot.rpg,i.repeat.set(.05,.1),i.offset.set(.1,.01),i.rotation=0;let o=[new ot.xoR({map:e}),new ot.xoR({map:i})],s=[];s.push(new ot.Pa4(this.startCoord.x,this.startCoord.y,0));for(let l=0;l<this.correctPath.length-1;l++)s.push(new ot.Pa4(this.correctPath[l].x,this.correctPath[l].y,0));s.push(new ot.Pa4(this.correctPath[0].x,this.correctPath[0].y,0));const n=new ot.YT8(s),a={steps:1400,bevelEnabled:!0,bevelThickness:1,bevelSegments:10,bevelSize:1,extrudePath:n};let r=new ot.bnF;r.moveTo(-1,-.8),r.lineTo(-1,1),r.lineTo(1.5,1),r.lineTo(1.5,-1),r.lineTo(-.8,-1),r.lineTo(-.9,-.95),r.lineTo(-.95,-.9);const d=new ot.O7d(r,a),h=new ot.Kj0(d,o);h.position.x=-4.5,h.position.y=-14,h.position.z=8,h.rotation.y=1.57,h.scale.x=.4,h.scale.y=.4,h.scale.z=.4,h.receiveShadow=!0,h.castShadow=!0,rt.add(h)}}};const ut=(0,d.Z)(pt,[["render",it],["__scopeId","data-v-97ca4a86"]]);var mt=ut;const gt=t=>((0,s.dD)("data-v-a398eaa0"),t=t(),(0,s.Cn)(),t),vt={class:"row"},wt=gt((()=>(0,s._)("div",{class:"col-2"},null,-1))),ft={class:"col-8"},bt=gt((()=>(0,s._)("div",{class:"col-2"},null,-1)));function yt(t,e,i,o,n,a){const r=(0,s.up)("canvas-paper");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",vt,[wt,(0,s._)("div",ft,[(0,s.Wm)(r,{dragMode:!t.canDraw,onClearSimp:a.clearSimp,"canvas-id":"canvas-one",ref:"childCanvas",onClearHandler:a.clearHandler,onNextButton:a.changeIndex,onSetPathCurveExternal:a.setPathCurveExternal,returnLastVertionTrigger:i.returnLastVertionTrigger},null,8,["dragMode","onClearSimp","onClearHandler","onNextButton","onSetPathCurveExternal","returnLastVertionTrigger"])]),bt])])}const xt=t=>((0,s.dD)("data-v-af075300"),t=t(),(0,s.Cn)(),t),Pt={class:"mainWrap"},Ct=["id"],St=xt((()=>(0,s._)("div",{class:"sizeMirriorCanvas"},"1600 ✖ 2000 мм",-1))),kt={class:"buttons-block"},Rt={class:"buttons-wrap"},_t={class:"regular-buttons-wrap"},Mt={key:0,class:"button-text"},It={class:"btn-tool-arrow-wrap"},Lt={key:0,class:"button-text"},Tt={key:0,class:"button-text"},jt={key:0,class:"button-text"},zt={key:0,class:"button-text"},At={class:"second-row-buttons-wrap"},Dt={style:{display:"flex","flex-direction":"column"}},Et=xt((()=>(0,s._)("label",{for:"volume",class:"smoothing-label"},"СГЛАЖИВАНИЕ",-1))),Wt=["disabled"];function Ht(t,e,i,o,n,a){const r=(0,s.up)("Delete"),d=(0,s.up)("el-icon"),h=(0,s.up)("el-button"),l=(0,s.up)("Undo"),c=(0,s.up)("Redo"),p=(0,s.up)("ArrowExpand"),u=(0,s.up)("VectorCurve");return(0,s.wg)(),(0,s.iD)("div",Pt,[(0,s._)("div",null,[(0,s._)("canvas",{id:i.canvasId,resize:"true",class:"canvas-style",onMousedown:e[0]||(e[0]=(...t)=>a.mouseDown&&a.mouseDown(...t))},null,40,Ct),St]),(0,s._)("div",kt,[(0,s._)("div",Rt,[(0,s._)("div",_t,[(0,s.Wm)(h,{disabled:!i.dragMode,onClick:a.clearPaper,class:"btn-wrap btn-tool"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{size:a.getIconSize(),style:{"margin-top":"-5px","margin-right":"3px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(r)])),_:1},8,["size"]),t.widthScreen>570?((0,s.wg)(),(0,s.iD)("span",Mt,"ОЧИСТИТЬ")):(0,s.kq)("",!0)])),_:1},8,["disabled","onClick"]),(0,s._)("div",It,[(0,s.Wm)(h,{disabled:!t.currentIndex,onClick:e[1]||(e[1]=t=>a.back(!1)),class:"btn-wrap btn-tool-arrow"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{size:a.getIconSize(),style:{"margin-top":"-5px","margin-right":"3px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(l)])),_:1},8,["size"]),t.widthScreen>570?((0,s.wg)(),(0,s.iD)("span",Lt,"НАЗАД")):(0,s.kq)("",!0)])),_:1},8,["disabled"]),(0,s.Wm)(h,{disabled:t.pathHistory.length-1==t.currentIndex||!i.dragMode,onClick:a.forward,class:"btn-wrap btn-tool-arrow"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{size:a.getIconSize(),style:{"margin-top":"-5px","margin-right":"3px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(c)])),_:1},8,["size"]),t.widthScreen>570?((0,s.wg)(),(0,s.iD)("span",Tt,"ВПЕРЁД")):(0,s.kq)("",!0)])),_:1},8,["disabled","onClick"])]),(0,s.Wm)(h,{disabled:!i.dragMode,onClick:a.changeScale,class:"btn-wrap btn-tool"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{size:a.getIconSize(),style:{"margin-top":"-5px","margin-right":"3px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(p)])),_:1},8,["size"]),t.widthScreen>570?((0,s.wg)(),(0,s.iD)("span",jt,"МАСШТАБ")):(0,s.kq)("",!0)])),_:1},8,["disabled","onClick"]),(0,s.Wm)(h,{disabled:!i.dragMode,onClick:a.curveEditorHandler,class:"btn-wrap btn-tool"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{size:a.getIconSize(),style:{"margin-top":"-5px","margin-right":"3px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(u)])),_:1},8,["size"]),t.widthScreen>570?((0,s.wg)(),(0,s.iD)("span",zt,"КРИВЫЕ")):(0,s.kq)("",!0)])),_:1},8,["disabled","onClick"])]),(0,s._)("div",At,[(0,s._)("div",Dt,[Et,(0,s._)("input",{ref:"rate",type:"range",id:"volume",min:"2",max:"30",value:"2",onChange:e[2]||(e[2]=(...e)=>t.uuy&&t.uuy(...e)),onInput:e[3]||(e[3]=(...t)=>a.inputSimplify&&a.inputSimplify(...t)),disabled:!i.dragMode||t.fewSegments},null,40,Wt)]),(0,s.Wm)(h,{onClick:a.goToDrawPage,class:"select-frame-btn"},{default:(0,s.w5)((()=>[(0,s.Uk)(" ВЫБРАТЬ РАМУ ")])),_:1},8,["onClick"])])])])])}var Ot=i(1796),Ft=i(4902),Nt=i(5921),Bt=i(2228),Vt=i(6880);const $t=i(5445);var Zt={name:"CanvasPaper",components:{Undo:Ot.Z,Redo:Ft.Z,Delete:Nt.Z,ArrowExpand:Bt.Z,VectorCurve:Vt.Z},props:{canvasId:String,dragMode:Boolean,returnLastVertionTrigger:Boolean},emits:["clearSimp","clearHandler","nextButton"],data:()=>({widthScreen:window.innerWidth,pathHistory:[],currentIndex:0,pathSelected:!1,curveEditorMode:!1,scaleMode:!1,currentRotationPoint:null,sideScaleRectangleNumber:null,cornerScale:null,simpValue:2,fewSegments:!1,segment:null,segmentDot:null,segmentPointNumber:0,hitOptions:{segments:!0,stroke:!0,fill:!0,tolerance:1},hitOptionsExtended:{segments:!0,stroke:!0,fill:!0,tolerance:15},loop:0,crossedArr:[],FinArr:[],path:null,scope:null}),methods:{inputSimplify(t){let e=this;if(this.scaleMode&&(this.changeScale(),this.deleteRotationArrows()),this.simpValue<t.target.valueAsNumber){this.currentIndex++;let t=this.pathHistory[this.pathHistory.length-1].data;this.$emit("clearSimp"),e.path=new $t.Path(t),e.path.strokeColor="black",e.path.fillColor="red",e.path.flatten(1),e.path.simplify(4)}else this.simpValue-1==t.target.valueAsNumber&&this.back(!0);this.pathHistory.push({data:this.scope.project._children[0]._children.find((t=>"Path"==t.className)).pathData,simplify:!0}),this.deletePathCircles(),this.deleteSizeMirror(),this.drawCircles(),this.drawSize(),this.simpValue=t.target.valueAsNumber},getIconSize(){return window.innerWidth<890?15:20},curveEditorHandler(){let t=this;this.curveEditorMode?(t.path.fullySelected=!1,this.curveEditorMode=!1,this.deleteMiniPathCircles(),this.drawCircles()):(this.scaleMode&&(this.changeScale(),this.deleteRotationArrows()),t.path.fullySelected=!0,this.drawCirclesCurves(),this.curveEditorMode=!0,this.deletePathCircles())},goToDrawPage(){let t=this;this.scope.project._children[0]._children.find((t=>"Path"==t.className)).flatten(1),console.log(this.scope.project._children[0]._children.find((t=>"Path"==t.className))),console.log(t.path.getCrossings(t.path));let e=t.path.clone();e.name="red",t.path.scale(-1,1),t.path.strokeColor="#ffffff",t.path.fillColor="#ffffff",this.$emit("nextButton",this.scope.project._children[0]._children.find((t=>"Path"==t.className&&!t.name)).segments)},changeNormalSizeChildren(t){let e=this.scope.project._children[0]._children;for(let o=0;o<e.length;o++)"circle"==e[o].type&&e[o].radius>5?e[o].radius=10:e[o].type||(e.find((t=>"Path"==t.className)).strokeWidth=1);let i=this.scope.project.hitTest(t.point,this.hitOptions);i&&"circle"==i.item.type&&10==i.item.radius?e.find((t=>t.id==i.item.id)).radius=15:i&&"stroke"==i.type&&!this.scaleMode&&(e.find((t=>"Path"==t.className)).strokeWidth=3)},deleteScaleRectangle(){let t=this.scope.project.activeLayer.children;t["csaleRectangle"]&&t["topLeft"]&&t["topRight"]&&t["bottomLeft"]&&t["bottomRight"]&&(t["csaleRectangle"]&&t["csaleRectangle"].remove(),t["topLeft"]&&t["topLeft"].remove(),t["topRight"]&&t["topRight"].remove(),t["bottomLeft"]&&t["bottomLeft"].remove(),t["bottomRight"]&&t["bottomRight"].remove(),t["topTriangle"]&&t["topTriangle"].remove(),t["bottomTriangle"]&&t["bottomTriangle"].remove(),t["leftTriangle"]&&t["leftTriangle"].remove(),t["rightTriangle"]&&t["rightTriangle"].remove())},deleteRotationArrows(){let t=this.scope.project.activeLayer.children;t["bottomLeftRot"]&&t["bottomLeftRot"].remove(),t["bottomRightRot"]&&t["bottomRightRot"].remove(),t["topLeftRot"]&&t["topLeftRot"].remove(),t["topRightRot"]&&t["topRightRot"].remove()},drawScaleRectangle(){let t=this.scope.project._children[0]._children.find((t=>"Path"==t.className));var e=new $t.Rectangle(new $t.Point(t.bounds.topLeft.x,t.bounds.topLeft.y),new $t.Size(t.bounds.width,t.bounds.height)),i=new $t.Path.Rectangle(e);i.name="csaleRectangle",i.strokeColor="black",i.dashArray=[10,12];let o=new $t.Path.RegularPolygon(new $t.Point(t.bounds.rightCenter.x+6,t.bounds.rightCenter.y),3,8);o.fillColor="white",o.strokeColor="black",o.name="rightTriangle",o.rotate(90);let s=new $t.Path.RegularPolygon(new $t.Point(t.bounds.topCenter.x,t.bounds.topCenter.y-4),3,8);s.fillColor="white",s.strokeColor="black",s.name="topTriangle";let n=new $t.Path.RegularPolygon(new $t.Point(t.bounds.leftCenter.x-6,t.bounds.leftCenter.y),3,8);n.fillColor="white",n.strokeColor="black",n.name="leftTriangle",n.rotate(-90);let a=new $t.Path.RegularPolygon(new $t.Point(t.bounds.bottomCenter.x,t.bounds.bottomCenter.y+8),3,8);a.fillColor="white",a.strokeColor="black",a.name="bottomTriangle",a.rotate(180);let r=new $t.Path({segments:[[t.bounds.topLeft.x,t.bounds.topLeft.y],[t.bounds.topLeft.x+10,t.bounds.topLeft.y],[t.bounds.topLeft.x+10,t.bounds.topLeft.y-10],[t.bounds.topLeft.x-10,t.bounds.topLeft.y-10],[t.bounds.topLeft.x-10,t.bounds.topLeft.y+10],[t.bounds.topLeft.x,t.bounds.topLeft.y+10],[t.bounds.topLeft.x,t.bounds.topLeft.y]],strokeColor:"black",fillColor:"white",strokeWidth:1});r.name="topLeft";let d=new $t.Path({segments:[[t.bounds.topRight.x,t.bounds.topRight.y],[t.bounds.topRight.x,t.bounds.topRight.y+10],[t.bounds.topRight.x+10,t.bounds.topRight.y+10],[t.bounds.topRight.x+10,t.bounds.topRight.y-10],[t.bounds.topRight.x-10,t.bounds.topRight.y-10],[t.bounds.topRight.x-10,t.bounds.topRight.y],[t.bounds.topRight.x,t.bounds.topRight.y]],strokeColor:"black",fillColor:"white",strokeWidth:1});d.name="topRight";let h=new $t.Path({segments:[[t.bounds.bottomRight.x,t.bounds.bottomRight.y],[t.bounds.bottomRight.x,t.bounds.bottomRight.y-10],[t.bounds.bottomRight.x+10,t.bounds.bottomRight.y-10],[t.bounds.bottomRight.x+10,t.bounds.bottomRight.y+10],[t.bounds.bottomRight.x-10,t.bounds.bottomRight.y+10],[t.bounds.bottomRight.x-10,t.bounds.bottomRight.y],[t.bounds.bottomRight.x,t.bounds.bottomRight.y]],strokeColor:"black",fillColor:"white",strokeWidth:1});h.name="bottomRight";let l=new $t.Path({segments:[[t.bounds.bottomLeft.x,t.bounds.bottomLeft.y],[t.bounds.bottomLeft.x,t.bounds.bottomLeft.y-10],[t.bounds.bottomLeft.x-10,t.bounds.bottomLeft.y-10],[t.bounds.bottomLeft.x-10,t.bounds.bottomLeft.y+10],[t.bounds.bottomLeft.x+10,t.bounds.bottomLeft.y+10],[t.bounds.bottomLeft.x+10,t.bounds.bottomLeft.y],[t.bounds.bottomLeft.x,t.bounds.bottomLeft.y]],strokeColor:"black",fillColor:"white",strokeWidth:1});l.name="bottomLeft"},deleteMiniPathCircles(){while(this.scope.project.activeLayer.children["circlePahtMini"])this.scope.project.activeLayer.children["circlePahtMini"].remove()},deletePathCircles(){while(this.scope.project.activeLayer.children["circlePaht"])this.scope.project.activeLayer.children["circlePaht"].remove()},deleteSizeMirror(){while(this.scope.project.activeLayer.children["sizeMirror"])this.scope.project.activeLayer.children["sizeMirror"].remove()},changeScale(){if(this.scaleMode)this.scaleMode=!1,this.deleteScaleRectangle(),this.drawCircles();else{this.scaleMode=!0,this.deleteScaleRectangle(),this.drawScaleRectangle(),this.deletePathCircles();let t=this;t.path.fullySelected=!1,this.curveEditorMode=!1,this.deleteMiniPathCircles(),t.path.selected=!1}},forward(){let t=this;this.scaleMode=!1,this.currentIndex<this.pathHistory.length-1?(this.currentIndex++,this.pathHistory[this.currentIndex]&&this.pathHistory[this.currentIndex].simplify?this.forward():(this.$emit("clearSimp"),t.path=new $t.Path(this.pathHistory[this.currentIndex].data),t.path.strokeColor="black",t.path.fillColor="red",t.path.closed=!0)):this.currentIndex==this.pathHistory.length-1&&(this.$emit("clearSimp"),t.path=new $t.Path(this.pathHistory[this.currentIndex].data),t.path.strokeColor="black",t.path.fillColor="red",t.path.closed=!0)},addHistory(){},drawCirclesCurves(){if(!this.scaleMode){if(this.path._segments)for(let t=0;t<this.path._segments.length;t++){let e=new $t.Shape.Circle(new $t.Point(this.path._segments[t].curve.points[1].x,this.path._segments[t].curve.points[1].y),3);e.name="circlePahtMini",e.fillColor="rgba(0,157,236)";let i=new $t.Shape.Circle(new $t.Point(this.path._segments[t].curve.points[2].x,this.path._segments[t].curve.points[2].y),3);i.name="circlePahtMini",i.fillColor="rgba(0,157,236)"}this.path._segments.length>3?this.fewSegments=!1:this.fewSegments=!0}},drawSize(){let t=this.scope.project._children[0]._children.find((t=>"Path"==t.className)),e=1600*t.bounds.width/document.getElementById("canvas-one").offsetWidth,i=2e3*t.bounds.height/document.getElementById("canvas-one").offsetHeight,o=new $t.PointText(new $t.Point(t.bounds.bottomCenter.x,t.bounds.bottomCenter.y));o.justification="center",o.fillColor="black",o.content=""+(Math.round(e)+" ✖ "+Math.round(i)+" мм"),o.name="sizeMirror",o.position.y=o.position.y+25,window.innerWidth<890?o.fontSize=11:o.fontSize=15},drawCircles(){if(!this.scaleMode){let t=this.path;if(t._segments)for(let e=0;e<t._segments.length;e++){let i=new $t.Shape.Circle(new $t.Point(t._segments[e].point.x,t._segments[e].point.y),10);i.strokeColor="rgba(0,38,32,0.5)",i.name="circlePaht",i.fillColor="rgba(0,255,217,0.2)"}t._segments.length>3?this.fewSegments=!1:this.fewSegments=!0}},clearPaper(){this.pathHistory=[],this.currentIndex=0,this.scaleMode=!1,this.curveEditorMode=!1,this.simpValue=2,this.$emit("clearHandler",!0)},back(t=!1){if(this.scaleMode=!1,this.curveEditorMode=!1,this.currentIndex>0)if(this.currentIndex--,this.pathHistory[this.currentIndex-1]&&this.pathHistory[this.currentIndex-1].simplify&&0==t)console.log("back"),this.back();else{if(t&&this.pathHistory[this.currentIndex]&&!this.pathHistory[this.currentIndex].simplify)return console.log("555"),0;let e=this;this.$emit("clearSimp"),e.path=new $t.Path(this.pathHistory[this.currentIndex].data),e.path.strokeColor="black",e.path.fillColor="red",e.path.closed=!0,this.simpValue}},drawRotationArrow(t){let e=this.scope.project.activeLayer.children.filter((t=>"bottomLeft"==t.name||"bottomRight"==t.name||"topLeft"==t.name||"topRight"==t.name)),i=1e4,o=null;for(let z=0;z<e.length;z++){let s=Math.abs(t.point.x-e[z].position.x),n=Math.abs(t.point.y-e[z].position.y);n+s<i&&(i=n+s,o=z)}let s=e[o];if(s)switch(s.name){case"topRight":var n=new $t.Path.Arc(new $t.Point(s.position.x-5,s.position.y-30),new $t.Point(s.position.x+18,s.position.y-18),new $t.Point(s.position.x+30,s.position.y+5));n.add(new $t.Point(s.position.x+20,s.position.y+5)),n.add(new $t.Point(s.position.x+35,s.position.y+20)),n.add(new $t.Point(s.position.x+50,s.position.y+5)),n.add(new $t.Point(s.position.x+40,s.position.y+5));var a=new $t.Point(42,0),r=new $t.Point(3,-3),d=new $t.Point(s.position.x+40,s.position.y+5),h=new $t.Segment(d,null,r),l=new $t.Point(s.position.x-5,s.position.y-40),c=new $t.Segment(l,a,null);n.add(h),n.add(c),n.add(new $t.Point(s.position.x-5,s.position.y-50)),n.add(new $t.Point(s.position.x-20,s.position.y-35)),n.add(new $t.Point(s.position.x-5,s.position.y-20)),n.add(new $t.Point(s.position.x-5,s.position.y-30)),n.strokeColor="black",n.fillColor="white",n.name="topRightRot";break;case"topLeft":var p=new $t.Path.Arc(new $t.Point(s.position.x+5,s.position.y-30),new $t.Point(s.position.x-18,s.position.y-18),new $t.Point(s.position.x-30,s.position.y+5));p.add(new $t.Point(s.position.x-20,s.position.y+5)),p.add(new $t.Point(s.position.x-35,s.position.y+20)),p.add(new $t.Point(s.position.x-50,s.position.y+5)),p.add(new $t.Point(s.position.x-40,s.position.y+5));var u=new $t.Point(-42,0),m=new $t.Point(-3,-3),g=new $t.Point(s.position.x-40,s.position.y+5),v=new $t.Segment(g,null,m),w=new $t.Point(s.position.x+5,s.position.y-40),f=new $t.Segment(w,u,null);p.add(v),p.add(f),p.add(new $t.Point(s.position.x+5,s.position.y-50)),p.add(new $t.Point(s.position.x+20,s.position.y-35)),p.add(new $t.Point(s.position.x+5,s.position.y-20)),p.add(new $t.Point(s.position.x+5,s.position.y-30)),p.strokeColor="black",p.fillColor="white",p.name="topLeftRot";break;case"bottomRight":var b=new $t.Path.Arc(new $t.Point(s.position.x+30,s.position.y-5),new $t.Point(s.position.x+18,s.position.y+18),new $t.Point(s.position.x-5,s.position.y+30));b.add(new $t.Point(s.position.x-5,s.position.y+20)),b.add(new $t.Point(s.position.x-20,s.position.y+35)),b.add(new $t.Point(s.position.x-5,s.position.y+50)),b.add(new $t.Point(s.position.x-5,s.position.y+40));var y=new $t.Point(3,3),x=new $t.Point(42,0),P=new $t.Point(s.position.x-5,s.position.y+40),C=new $t.Segment(P,null,x),S=new $t.Point(s.position.x+40,s.position.y-5),k=new $t.Segment(S,y,null);b.add(C),b.add(k),b.add(new $t.Point(s.position.x+50,s.position.y-5)),b.add(new $t.Point(s.position.x+35,s.position.y-20)),b.add(new $t.Point(s.position.x+20,s.position.y-5)),b.add(new $t.Point(s.position.x+30,s.position.y-5)),b.strokeColor="black",b.fillColor="white",b.name="bottomRightRot";break;case"bottomLeft":var R=new $t.Path.Arc(new $t.Point(s.position.x-30,s.position.y-5),new $t.Point(s.position.x-18,s.position.y+18),new $t.Point(s.position.x+5,s.position.y+30));R.add(new $t.Point(s.position.x+5,s.position.y+20)),R.add(new $t.Point(s.position.x+20,s.position.y+35)),R.add(new $t.Point(s.position.x+5,s.position.y+50)),R.add(new $t.Point(s.position.x+5,s.position.y+40));var _=new $t.Point(-3,3),M=new $t.Point(-42,0),I=new $t.Point(s.position.x+5,s.position.y+40),L=new $t.Segment(I,null,M),T=new $t.Point(s.position.x-40,s.position.y-5),j=new $t.Segment(T,_,null);R.add(L),R.add(j),R.add(new $t.Point(s.position.x-50,s.position.y-5)),R.add(new $t.Point(s.position.x-35,s.position.y-20)),R.add(new $t.Point(s.position.x-20,s.position.y-5)),R.add(new $t.Point(s.position.x-30,s.position.y-5)),R.strokeColor="black",R.fillColor="white",R.name="bottomLeftRot";break}},cutCrossings(t){let e=[];for(let a=0;a<this.crossedArr.length;a++){let i=1e4,o=null;for(let e=0;e<t.length;e++){let s=Math.abs(t[e].x-this.crossedArr[a]._point.x),n=Math.abs(t[e].y-this.crossedArr[a]._point.y);n+s<i&&(i=n+s,o=e)}e.push({firstIndex:o,indexCross:a,point:{x:this.crossedArr[a]._point.x,y:this.crossedArr[a]._point.y}}),t[o].cross=!0,t[o].crossIndex=a}for(let a=0;a<this.crossedArr.length;a++){let i=1e4,o=null,s=!0;for(let e=0;e<t.length;e++)if(s=!0,t[e+1]&&t[e+1].cross&&(s=!1),t[e-1]&&t[e-1].cross&&(s=!1),!t[e].cross&&s){let s=Math.abs(t[e].x-this.crossedArr[a]._point.x),n=Math.abs(t[e].y-this.crossedArr[a]._point.y);n+s<i&&(i=n+s,o=e)}t[o]&&(t[o].crossDouble=!0,t[o].crossIndex=a,e.find((t=>t.indexCross==a)).secondIndex=o)}for(let a=0;a<e.length;a++)e[a].count=Math.abs(e[a].firstIndex-e[a].secondIndex);let i=JSON.parse(JSON.stringify(t));i.reverse(),e.push({count:i.indexOf(i.find((t=>void 0!==t.crossIndex)))+t.indexOf(t.find((t=>void 0!==t.crossIndex))),end:t.length-i.indexOf(i.find((t=>void 0!==t.crossIndex)))-1,start:t.indexOf(t.find((t=>void 0!==t.crossIndex)))});let o=1/0,s=null;for(let a=0;a<e.length;a++)e[a].count<o&&(o=e[a].count,s=a);let n=JSON.parse(JSON.stringify(t));s==e.length-1?(console.log("хвостик"),n.splice(0,e[e.length-1].start+1),n.splice(e[e.length-1].end-e[e.length-1].start,1e4)):(console.log("петля"),n.splice(Math.min(e[s].firstIndex,e[s].secondIndex),o+1,e[s].point)),this.FinArr=n,self.path=new $t.Path;for(let a=0;a<this.FinArr.length;a++)self.path.add(new $t.Point(this.FinArr[a].x,this.FinArr[a].y));return self.path.closed=!0,this.crossedArr=self.path.getCrossings(self.path),0==this.crossedArr.length||1==this.crossedArr.length&&this.crossedArr[0]._point.x==this.FinArr[this.FinArr.length-1].x&&this.crossedArr[0]._point.y==this.FinArr[this.FinArr.length-1].y?console.log("last"):(this.loop++,this.cutCrossings(this.FinArr)),n},getCrossIndex(t,e,i){let o=1e4,s=null;for(let n=0;n<t.length;n++){let a=Math.abs(t[n].x-e),r=Math.abs(t[n].y-i);r+a<o&&(o=r+a,s=n)}return s},reset(){this.scope.project.activeLayer.removeChildren()},pathCreate(t){return t.activate(),new $t.Path({strokeColor:"rgb(77,77,77)",strokeJoin:"round",strokeWidth:2})},createTool(t){return t.activate(),new $t.Tool},mouseDown(){console.log("Doe");let t=this;this.dragMode||(this.tool=this.createTool(this.scope)),this.tool.onMouseDown=e=>{if(this.dragMode)if(this.pathSelected=!1,this.scaleMode){this.sideScaleRectangleNumber=null,this.cornerScale=null,this.currentRotationPoint=null;let t=this.scope.project.hitTest(e.point,this.hitOptions),i=this.scope.project.hitTest(e.point,this.hitOptionsExtended);if(t){let e=t.type;t.item.name||"fill"!=e||(this.pathSelected=!0),"topRightRot"==t.item.name||"bottomRightRot"==t.item.name||"bottomLeftRot"==t.item.name||"topLeftRot"==t.item.name?this.currentRotationPoint=t.item.name:"topRight"==t.item.name||"topLeft"==t.item.name||"bottomRight"==t.item.name||"bottomLeft"==t.item.name?this.cornerScale=t.item.name:"stroke"==e&&"csaleRectangle"==t.item.name&&(this.sideScaleRectangleNumber=t.item.curves.findIndex((e=>e.point1.x==t.location.curve.point1.x&&e.point1.y==t.location.curve.point1.y)))}if(i&&("rightTriangle"==i.item.name||"topTriangle"==i.item.name||"bottomTriangle"==i.item.name||"leftTriangle"==i.item.name))switch(i.item.name){case"rightTriangle":this.sideScaleRectangleNumber=2;break;case"topTriangle":this.sideScaleRectangleNumber=1;break;case"bottomTriangle":this.sideScaleRectangleNumber=3;break;case"leftTriangle":this.sideScaleRectangleNumber=0;break}t||i||(this.changeScale(),this.deleteRotationArrows())}else{this.segment=null,this.segmentDot=null,this.segmentPointNumber=0;let t=this.scope.project.hitTest(e.point,this.hitOptionsExtended);if(!t&&this.curveEditorMode)return void this.curveEditorHandler();if(t){if(t.item.name||"fill"!=t.type||(this.pathSelected=!0),"circle"===t.item._type)if(3===t.item.radius)for(let e=0;e<this.path._segments.length;e++)this.path._segments[e].curve.points[1].x==t.item.position.x&&this.path._segments[e].curve.points[1].y==t.item.position.y?(this.segmentDot=this.path._segments[e],this.segmentPointNumber=1):this.path._segments[e].curve.points[2].x==t.item.position.x&&this.path._segments[e].curve.points[2].y==t.item.position.y&&(this.segmentDot=this.path._segments[e],this.segmentPointNumber=2);else for(let e=0;e<this.path._segments.length;e++)Math.trunc(this.path._segments[e].point.x)==Math.trunc(t.item.position.x)&&Math.trunc(this.path._segments[e].point.y)==Math.trunc(t.item.position.y)&&(this.segment=this.path._segments[e]);"segment"==t.type?this.segment=t.segment:"stroke"==t.type&&"circle"!=t.item._type&&(this.segment=this.path.insert(t.location.index+1,e.point))}}else t.path=t.pathCreate(t.scope),t.path.add(e.point)},this.tool.onMouseMove=t=>{this.scaleMode&&(this.deleteRotationArrows(),this.drawRotationArrow(t)),this.changeNormalSizeChildren(t)},this.tool.onMouseDrag=e=>{if(this.deleteSizeMirror(),this.deletePathCircles(),this.deleteMiniPathCircles(),this.dragMode)if(this.scaleMode){if(this.cornerScale){switch(this.cornerScale){case"topRight":(e.delta.x>0&&e.delta.y<0||e.delta.x<0&&e.delta.y>0)&&(e.delta.x>0?this.path.scale(1.01,1):this.path.scale(.99,1),e.delta.y<0?this.path.scale(1,1.01):this.path.scale(1,.99));break;case"topLeft":(e.delta.x>0&&e.delta.y>0||e.delta.x<0&&e.delta.y<0)&&(e.delta.y<0?this.path.scale(1,1.02):this.path.scale(1,.98),e.delta.x<0?this.path.scale(1.02,1):this.path.scale(.98,1));break;case"bottomRight":(e.delta.x>0&&e.delta.y>0||e.delta.x<0&&e.delta.y<0)&&(e.delta.y>0?this.path.scale(1,1.02):this.path.scale(1,.98),e.delta.x>0?this.path.scale(1.02,1):this.path.scale(.98,1));break;case"bottomLeft":(e.delta.x>0&&e.delta.y<0||e.delta.x<0&&e.delta.y>0)&&(e.delta.x<0?this.path.scale(1.02,1):this.path.scale(.98,1),e.delta.y>0?this.path.scale(1,1.02):this.path.scale(1,.98));break}this.deleteScaleRectangle(),this.drawScaleRectangle(),this.deleteRotationArrows(),this.drawRotationArrow(e)}else if(null===this.sideScaleRectangleNumber)if(this.currentRotationPoint){let t=this.scope.project._children[0]._children["csaleRectangle"],i=this.scope.project._children[0]._children.find((t=>"topRightRot"==t.name||"topLeftRot"==t.name||"bottomRightRot"==t.name||"bottomLeftRot"==t.name)),o=this.scope.project._children[0]._children["topRight"],s=this.scope.project._children[0]._children["topLeft"],n=this.scope.project._children[0]._children["bottomRight"],a=this.scope.project._children[0]._children["bottomLeft"],r=this.scope.project._children[0]._children["rightTriangle"],d=this.scope.project._children[0]._children["leftTriangle"],h=this.scope.project._children[0]._children["bottomTriangle"],l=this.scope.project._children[0]._children["topTriangle"];e.point.x<this.path.bounds.center.x&&e.point.y>this.path.bounds.center.y?e.delta.x<0||e.delta.y<0?(this.path.rotate(1.3),i.rotate(1.3,this.path.bounds.center),t.rotate(1.3,this.path.bounds.center),a.rotate(1.3,this.path.bounds.center),n.rotate(1.3,this.path.bounds.center),s.rotate(1.3,this.path.bounds.center),o.rotate(1.3,this.path.bounds.center),r.rotate(1.3,this.path.bounds.center),d.rotate(1.3,this.path.bounds.center),h.rotate(1.3,this.path.bounds.center),l.rotate(1.3,this.path.bounds.center)):(this.path.rotate(-1.3),i.rotate(-1.3,this.path.bounds.center),t.rotate(-1.3,this.path.bounds.center),a.rotate(-1.3,this.path.bounds.center),n.rotate(-1.3,this.path.bounds.center),s.rotate(-1.3,this.path.bounds.center),o.rotate(-1.3,this.path.bounds.center),r.rotate(-1.3,this.path.bounds.center),d.rotate(-1.3,this.path.bounds.center),h.rotate(-1.3,this.path.bounds.center),l.rotate(-1.3,this.path.bounds.center)):e.point.y>this.path.bounds.center.y?e.delta.x<0||e.delta.y>0?(this.path.rotate(1.3),i.rotate(1.3,this.path.bounds.center),t.rotate(1.3,this.path.bounds.center),a.rotate(1.3,this.path.bounds.center),n.rotate(1.3,this.path.bounds.center),s.rotate(1.3,this.path.bounds.center),o.rotate(1.3,this.path.bounds.center),r.rotate(1.3,this.path.bounds.center),d.rotate(1.3,this.path.bounds.center),h.rotate(1.3,this.path.bounds.center),l.rotate(1.3,this.path.bounds.center)):(this.path.rotate(-1.3),i.rotate(-1.3,this.path.bounds.center),t.rotate(-1.3,this.path.bounds.center),a.rotate(-1.3,this.path.bounds.center),n.rotate(-1.3,this.path.bounds.center),s.rotate(-1.3,this.path.bounds.center),o.rotate(-1.3,this.path.bounds.center),r.rotate(-1.3,this.path.bounds.center),d.rotate(-1.3,this.path.bounds.center),h.rotate(-1.3,this.path.bounds.center),l.rotate(-1.3,this.path.bounds.center)):e.point.x<this.path.bounds.center.x?e.delta.x>0||e.delta.y<0?(this.path.rotate(1.3),i.rotate(1.3,this.path.bounds.center),t.rotate(1.3,this.path.bounds.center),a.rotate(1.3,this.path.bounds.center),n.rotate(1.3,this.path.bounds.center),s.rotate(1.3,this.path.bounds.center),o.rotate(1.3,this.path.bounds.center),r.rotate(1.3,this.path.bounds.center),d.rotate(1.3,this.path.bounds.center),h.rotate(1.3,this.path.bounds.center),l.rotate(1.3,this.path.bounds.center)):(this.path.rotate(-1.3),i.rotate(-1.3,this.path.bounds.center),t.rotate(-1.3,this.path.bounds.center),a.rotate(-1.3,this.path.bounds.center),n.rotate(-1.3,this.path.bounds.center),s.rotate(-1.3,this.path.bounds.center),o.rotate(-1.3,this.path.bounds.center),r.rotate(-1.3,this.path.bounds.center),d.rotate(-1.3,this.path.bounds.center),h.rotate(-1.3,this.path.bounds.center),l.rotate(-1.3,this.path.bounds.center)):e.delta.x>0||e.delta.y>0?(this.path.rotate(1.3),i.rotate(1.3,this.path.bounds.center),t.rotate(1.3,this.path.bounds.center),a.rotate(1.3,this.path.bounds.center),n.rotate(1.3,this.path.bounds.center),s.rotate(1.3,this.path.bounds.center),o.rotate(1.3,this.path.bounds.center),r.rotate(1.3,this.path.bounds.center),d.rotate(1.3,this.path.bounds.center),h.rotate(1.3,this.path.bounds.center),l.rotate(1.3,this.path.bounds.center)):(this.path.rotate(-1.3),i.rotate(-1.3,this.path.bounds.center),t.rotate(-1.3,this.path.bounds.center),a.rotate(-1.3,this.path.bounds.center),n.rotate(-1.3,this.path.bounds.center),s.rotate(-1.3,this.path.bounds.center),o.rotate(-1.3,this.path.bounds.center),r.rotate(-1.3,this.path.bounds.center),d.rotate(-1.3,this.path.bounds.center),h.rotate(-1.3,this.path.bounds.center),l.rotate(-1.3,this.path.bounds.center))}else this.path.position.x+=e.delta.x,this.path.position.y+=e.delta.y,this.deleteScaleRectangle(),this.drawScaleRectangle(),this.deleteRotationArrows(),this.drawRotationArrow(e);else if(null!==this.sideScaleRectangleNumber){switch(this.sideScaleRectangleNumber){case 0:e.delta.x<0?this.path.scale(1.03,1):this.path.scale(.97,1);break;case 1:e.delta.y<0?this.path.scale(1,1.04):this.path.scale(1,.97);break;case 2:e.delta.x>0?this.path.scale(1.03,1):this.path.scale(.97,1);break;case 3:e.delta.y>0?this.path.scale(1,1.04):this.path.scale(1,.97);break}this.deleteScaleRectangle(),this.drawScaleRectangle(),this.deleteRotationArrows(),this.drawRotationArrow(e)}}else this.deleteSizeMirror(),this.drawSize(),this.segmentDot?(console.log(11),1==this.segmentPointNumber?(this.segmentDot.curve.handle1.x+=e.delta.x,this.segmentDot.curve.handle1.y+=e.delta.y):2==this.segmentPointNumber&&(this.segmentDot.curve.handle2.x+=e.delta.x,this.segmentDot.curve.handle2.y+=e.delta.y),console.log(this.segmentDot.curve.points[2])):this.segment?(this.segment.point.x+=e.delta.x,this.segment.point.y+=e.delta.y):this.pathSelected&&(this.path.position.x+=e.delta.x,this.path.position.y+=e.delta.y);else t.path.add(e),t.path.fillColor="#efefef"},this.tool.onMouseUp=()=>{let t=this;if(this.dragMode)this.scaleMode&&(this.deleteScaleRectangle(),this.drawScaleRectangle()),this.currentIndex!=this.pathHistory.length-1&&this.pathHistory.splice(this.currentIndex+1,1/0),this.pathHistory.push({data:this.scope.project._children[0]._children.find((t=>"Path"==t.className)).pathData}),this.currentIndex=this.pathHistory.length-1,this.$refs.rate.value=2,console.log("HISTORY"),console.log(this.scope.project._children[0]._children.find((t=>"Path"==t.className)));else{t.path.add(new $t.Point(t.path.curves[0].point1._x,t.path.curves[0].point1._y)),this.crossedArr=t.path.getCrossings(t.path);let e=[];for(let i=0;i<t.path.curves.length;i++)for(let o=0;o<t.path.curves[i].points.length;o++)e[e.length-1]&&e[e.length-1].x==t.path.curves[i].points[o].x&&e[e.length-1].y==t.path.curves[i].points[o].y||e.push({x:t.path.curves[i].points[o].x,y:t.path.curves[i].points[o].y});this.crossedArr.length?this.cutCrossings(e):this.FinArr=e,this.$emit("clearHandler",!1),t.path=new $t.Path,t.path.strokeColor="black";for(let i=0;i<this.FinArr.length;i++)t.path.add(new $t.Point(this.FinArr[i].x,this.FinArr[i].y));t.path.closed=!0,t.path.fillColor={hue:360*Math.random(),saturation:1,lightness:.4*(Math.random()-.5)+.4},t.path.simplify(30),this.currentIndex!=this.pathHistory.length-1&&this.pathHistory.splice(this.currentIndex+1,1/0),this.pathHistory.push({data:this.scope.project._children[0]._children.find((t=>"Path"==t.className)).pathData}),this.currentIndex=this.pathHistory.length-1,this.$refs.rate.value=2}this.deletePathCircles(),this.deleteSizeMirror(),this.drawSize(),this.curveEditorMode?this.drawCirclesCurves():this.drawCircles()}}},mounted(){this.scope=new $t.PaperScope,this.scope.setup(this.canvasId),window.innerWidth>1465?this.scope.project.view.viewSize=["600","750"]:window.innerWidth>1024?this.scope.project.view.viewSize=["456","570"]:window.innerWidth>890?this.scope.project.view.viewSize=["400","500"]:window.innerWidth>700?this.scope.project.view.viewSize=["320","400"]:window.innerWidth>570?this.scope.project.view.viewSize=["280","350"]:window.innerWidth>370?this.scope.project.view.viewSize=["320","400"]:this.scope.project.view.viewSize=["280","350"],this.mouseDown()},watch:{returnLastVertionTrigger(){console.log("returnLastVertionTrigger");let t=this;this.$emit("clearSimp"),t.path=new $t.Path(this.pathHistory[this.currentIndex].data),t.path.strokeColor="black",t.path.fillColor="red",t.path.closed=!0,this.drawCircles(),this.drawSize()}}};const qt=(0,d.Z)(Zt,[["render",Ht],["__scopeId","data-v-af075300"]]);var Ut=qt,Gt={name:"MasterPaper",data:()=>({canDraw:!0}),props:{returnLastVertionTrigger:Boolean},methods:{setPathCurveExternal(t){this.$emit("setPathCurveExternal",t)},changeIndex(t){this.$emit("changeIndex",1,t)},clearHandler(t){this.canDraw=t,this.$refs.childCanvas.reset()},clearSimp(){this.$refs.childCanvas.reset()}},components:{CanvasPaper:Ut}};const Yt=(0,d.Z)(Gt,[["render",yt],["__scopeId","data-v-a398eaa0"]]);var Jt=Yt,Kt=i(480),Xt={name:"DrawPage",data:()=>({returnLastVertionTrigger:!1,upHere:!1,pathCurve:null,pathCurveExternal:null,widthScreen:window.innerWidth}),components:{masterPaper:Jt,mainWrap:mt,ArrowLeft:Kt.Z},methods:{setPathCurveExternal(t){console.log(t),this.pathCurveExternal=t},setActiveItem(t,e){this.pathCurve=e,0==t&&(this.returnLastVertionTrigger=!this.returnLastVertionTrigger),this.$refs.carousel.setActiveItem(t)}}};const Qt=(0,d.Z)(Xt,[["render",B]]);var te=Qt,ee=(0,c.p7)({history:(0,c.PO)(),routes:[{path:"/",component:E},{path:"/draw",component:te}]}),ie=i(3765),oe=i(2748);const se=(0,o.ri)(l);se.use(ee),se.use(ie.Z);for(const[ne,ae]of Object.entries(oe))se.component(ne,ae);se.mount("#app")},858:function(){},4158:function(){}},e={};function i(o){var s=e[o];if(void 0!==s)return s.exports;var n=e[o]={exports:{}};return t[o].call(n.exports,n,n.exports,i),n.exports}i.m=t,function(){var t=[];i.O=function(e,o,s,n){if(!o){var a=1/0;for(l=0;l<t.length;l++){o=t[l][0],s=t[l][1],n=t[l][2];for(var r=!0,d=0;d<o.length;d++)(!1&n||a>=n)&&Object.keys(i.O).every((function(t){return i.O[t](o[d])}))?o.splice(d--,1):(r=!1,n<a&&(a=n));if(r){t.splice(l--,1);var h=s();void 0!==h&&(e=h)}}return e}n=n||0;for(var l=t.length;l>0&&t[l-1][2]>n;l--)t[l]=t[l-1];t[l]=[o,s,n]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var o in e)i.o(e,o)&&!i.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){i.p="/mirror/"}(),function(){var t={143:0};i.O.j=function(e){return 0===t[e]};var e=function(e,o){var s,n,a=o[0],r=o[1],d=o[2],h=0;if(a.some((function(e){return 0!==t[e]}))){for(s in r)i.o(r,s)&&(i.m[s]=r[s]);if(d)var l=d(i)}for(e&&e(o);h<a.length;h++)n=a[h],i.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return i.O(l)},o=self["webpackChunkhello_world"]=self["webpackChunkhello_world"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=i.O(void 0,[998],(function(){return i(9675)}));o=i.O(o)})();
//# sourceMappingURL=app.1f52149e.js.map